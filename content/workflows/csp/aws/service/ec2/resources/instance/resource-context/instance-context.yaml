schema: 1
type: resource-context

id: ec2-instance-context
name: EC2 instance general context

csp: aws
service: ec2
resource-type: instance

filters:
  - match-type: any
    rules:
      - .resourceType == "instance" and .csp =="aws"

steps:
  - id: ec2Exposure
    uses: WhatIsEc2Exposure
    with:
      - name: instanceArn
        value: .canonicalId

risk-config:
  default-risk: ""
  rules:
    - name: Can EC2 receive unauthenticated traffic
      condition: .ec2Exposure.appLayer.canReceiveUnauthenticatedTraffic == true
      risk: high
